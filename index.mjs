// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-accessor@v0.2.2-esm/index.mjs";import{isPrimitive as n}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-arraybuffer@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-filled@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-index-of@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-buffer@v0.2.2-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dataview@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-write-accessor@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-read-only-accessor@v0.2.2-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-read-write-accessor@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-little-endian@v0.2.2-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/boolean-ctor@v0.2.2-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-cmplx@v0.2.2-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/array-typed@v0.3.0-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-real-floating-point-data-type@v0.2.1-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-signed-integer-data-type@v0.2.1-esm/index.mjs";import{isPrimitive as x}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-number@v0.2.2-esm/index.mjs";import{isPrimitive as O}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.2.2-esm/index.mjs";import{isPrimitive as E}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@v0.2.2-esm/index.mjs";import{isPrimitive as T}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-bigint@v0.2.2-esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-complex-like@v0.2.2-esm/index.mjs";import L from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-allowed-data-type-cast@v0.2.2-esm/index.mjs";import S from"https://cdn.jsdelivr.net/gh/stdlib-js/array-min-dtype@v0.3.0-esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-min-signed-integer-dtype@v0.2.2-esm/index.mjs";import U from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-dtype@v0.2.2-esm/index.mjs";import I from"https://cdn.jsdelivr.net/gh/stdlib-js/number-ctor@esm/index.mjs";import J from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-little-endian@esm/index.mjs";import{isPrimitive as N}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import{isPrimitive as P}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-bigint@esm/index.mjs";import M from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-complex-like@esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-allowed-data-type-cast@esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-dtype@esm/index.mjs";import{isPrimitive as A}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-number@esm/index.mjs";import B from"https://cdn.jsdelivr.net/gh/stdlib-js/boolean-ctor@esm/index.mjs";import{isPrimitive as R}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@esm/index.mjs";import D from"https://cdn.jsdelivr.net/gh/stdlib-js/array-min-dtype@esm/index.mjs";import $ from"https://cdn.jsdelivr.net/gh/stdlib-js/bigint-ctor@esm/index.mjs";import z from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-floor@v0.2.3-esm/index.mjs";import q from"https://cdn.jsdelivr.net/gh/stdlib-js/array-uint8@esm/index.mjs";import C from"https://cdn.jsdelivr.net/gh/stdlib-js/blas-base-gcopy@esm/index.mjs";import{isPrimitive as G}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-integer@v0.2.2-esm/index.mjs";import H from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-dataview@v0.2.2-esm/index.mjs";import K from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-complex-floating-point-data-type@esm/index.mjs";import Q from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-boolean-data-type@esm/index.mjs";import W from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-real-data-type@esm/index.mjs";import X from"https://cdn.jsdelivr.net/gh/stdlib-js/array-typed@esm/index.mjs";import Y from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dtype@esm/index.mjs";import Z from"https://cdn.jsdelivr.net/gh/stdlib-js/strided-base-reinterpret-complex@esm/index.mjs";import tt from"https://cdn.jsdelivr.net/gh/stdlib-js/strided-base-reinterpret-boolean@esm/index.mjs";import et from"https://cdn.jsdelivr.net/gh/stdlib-js/blas-ext-base-gfill@esm/index.mjs";import nt from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-map@esm/index.mjs";import st from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-constant-function@v0.2.2-esm/index.mjs";import{isPrimitive as rt}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import it,{factory as ot}from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import at from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-bytes-per-element@esm/index.mjs";import lt from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-fast-min@v0.3.0-esm/index.mjs";import dt from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import ft from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import mt from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import ut from"https://cdn.jsdelivr.net/gh/stdlib-js/array-to-json@v0.3.0-esm/index.mjs";var pt="__@@##$$@@__struct_buffer__@@$$##@@__",ct="Struct",gt={int8:{get:"getInt8",set:"setInt8"},int16:{get:"getInt16",set:"setInt16"},int32:{get:"getInt32",set:"setInt32"},int64:{get:"getBigInt64",set:"setBigInt64"},uint8:{get:"getUint8",set:"setUint8"},uint16:{get:"getUint16",set:"setUint16"},uint32:{get:"getUint32",set:"setUint32"},uint64:{get:"getBigUint64",set:"setBigUint64"},float16:{get:"getFloat16",set:"setFloat16"},float32:{get:"getFloat32",set:"setFloat32"},float64:{get:"getFloat64",set:"setFloat64"},complex32:{get:"getFloat16",set:"setFloat16"},complex64:{get:"getFloat32",set:"setFloat32"},complex128:{get:"getFloat64",set:"setFloat64"},bool:{get:"getUint8",set:"setUint8"}};var ht={complex128:"float64",complex64:"float32",complex32:"float16"};function yt(t){if(t.length)return t.isStructType?function(t){return function(){var e,n,s,r;for(e=(n=this[pt]).byteOffset+t.byteOffset,s=[],r=0;r<t.length;r++)s.push(new t.type.constructor(n.buffer,e,t.byteLength)),e+=t.byteOffset;return s}}(t):function(t){return function(){var e=this[pt];return v(e.buffer,e.byteOffset+t.byteOffset,t.length,t.type)}}(t);switch(t.type){case"float64":case"float32":case"float16":case"int8":case"int16":case"int32":case"uint8":case"uint16":case"uint32":case"int64":case"uint64":return function(t,e){return function(){return this[pt][e](t.byteOffset,h)}}(t,gt[t.type].get);case"bool":return function(t,e){return function(){return y(this[pt][e](t.byteOffset,h))}}(t,gt[t.type].get);case"complex128":case"complex64":case"complex32":return function(t,e){return function(){var n=this[pt][e](t.byteOffset,h),s=this[pt][e](t.byteOffset+t.byteLength/2,h);return b(n,s,ht[t.type])}}(t,gt[t.type].get);default:if(t.isStructType)return function(t){return function(){var e=this[pt];return new t.type.constructor(e.buffer,e.byteOffset+t.byteOffset,t.byteLength)}}(t);throw new Error(u("unexpected error. Unrecognized data type. Value: `%s`.",t.type))}}function bt(t){return t?1:0}function vt(t){return I(t)}var jt={dtypes:{real:"float64",complex:"complex128"}};function wt(t){return y(t)}function xt(t){return y(t.re||t.im)}function Ot(t,e){return function(n){var s,r;N(n)?(s="bool",r=bt(n)):A(n)?(s=jt.dtypes.real,r=bt(wt(n))):P(n)?(s="int64",r=bt(function(t){return y(t)}(n))):M(n)?(s=k(n)||jt.dtypes.complex,r=bt(xt(n))):(s="generic",r=B(n));if(!_(s,t.type,t.castingMode))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[pt][e](t.byteOffset,r,h)}}function Et(t,e){return function(n){var s,r;P(n)?(s="int64",r=n):A(n)?R(n)?(s=D(n),r=$(n)):(s=jt.dtypes.real,r=$(z(n))):N(n)?(s="bool",r=function(t){return $(t?1:0)}(n)):V(n)?(s=k(n)||jt.dtypes.complex,r=$(z(n.re))):(s="generic",r=$(z(I(r))));if(!_(s,t.type,t.castingMode))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[pt][e](t.byteOffset,r,h)}}function Tt(t){return i(t)&&t.constructor.name===ct&&G(t.constructor.byteLength)&&H(t[pt])}function Vt(t){return t.re}function Lt(t){if(t.length)return t.isStructType?function(t){return function(e){var n,r,i,o,a,l,d,f;if(!s(e))throw new TypeError(u("invalid assignment. `%s` must be an array-like object. Value: `%s`.",t.name,e));if(e.length!==t.length)throw new RangeError(u("invalid assignment. `%s` must be an array-like object having length %u.",t.name,t.length));if("none"===t.casting)for(f=0;f<e.length;f++)if(!(e[f]instanceof t.type))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Value: `%s`.",t.name,e[f]));for(d=t.byteLength/t.length,r=[],f=0;f<e.length;f++){if((l=this.constructor.viewOf(e[f])).byteLength!==d)throw new RangeError(u("invalid assignment. `%s` must be an array-like object containing `struct` instances having the same byte length.",t.name));a=new q(l.buffer,l.byteOffset,d),r.push(a)}for(n=(i=this[pt]).byteOffset+t.byteOffset,f=0;f<e.length;f++)o=new q(i.buffer,n,d),C(t.length,r[f],1,o,1),n+=d}}(t):function(t){return function(e){var n,r;if(!s(e)||Tt(e))throw new TypeError(u("invalid assignment. `%s` must be an array-like object. Value: `%s`.",t.name,e));if(e.length!==t.length)throw new RangeError(u("invalid assignment. `%s` must be an array-like object having length %u.",t.name,t.length));if(r=Y(e),!_(r,t.type,t.castingMode))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,r));return n=X(this[pt].buffer,t.byteOffset,t.length,t.type),r===t.type?K(r)?void C(2*t.length,Z(e,0),1,Z(n,0),1):Q(r)?void C(t.length,tt(e,0),1,tt(n,0),1):void C(t.length,e,1,n,1):W(r)?W(t.type)?void C(t.length,e,1,n,1):K(t.type)?(n=Z(n,0),C(t.length,n,2,e,1),void et.ndarray(t.length,0,n,2,1)):void nt.assign(e,n,1,0,wt):K(r)?W(t.type)?void nt.assign(e,n,1,0,Vt):K(t.type)?void C(2*t.length,Z(e,0),1,Z(n,0),1):void nt.assign(e,n,1,0,xt):void(W(t.type)?C(t.length,tt(e,0),1,n,1):(n=Z(n,0),C(t.length,n,2,tt(e,0),1),et.ndarray(t.length,0,n,2,1)))}}(t);switch(t.type){case"float64":case"float32":case"float16":case"int8":case"int16":case"int32":case"uint8":case"uint16":case"uint32":return function(t,e){return function(n){var s,r;if(x(n)?(s=j(t.type)?t.type:E(n)?w(t.type)?F(n):S(n):jt.dtypes.real,r=n):V(n)?(s=U(n)||("float32"===t.type?"complex64":"complex128"),r=n.re):O(n)?(s="bool",r=bt(n)):T(n)?(s="int64",r=vt(n)):(s="generic",r=n),!L(s,t.type,t.castingMode))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[pt][e](t.byteOffset,r,h)}}(t,gt[t.type].set);case"int64":case"uint64":return Et(t,gt[t.type].set);case"bool":return Ot(t,gt[t.type].set);case"complex128":case"complex64":case"complex32":return function(t,e){return function(n){var s,r,i;if(M(n)?(s=k(n)||t.type,r=n.re,i=n.im):x(n)?(s="complex64"===t.type?"float32":"float64",r=n,i=0):P(n)?(s="int64",r=vt(n),i=0):N(n)?(s="bool",r=bt(n),i=0):(s="generic",r=n,i=0),!_(s,t.type,t.castingMode))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[pt][e](t.byteOffset,r,J),this[pt][e](t.byteOffset+t.byteLength/2,i,J)}}(t,gt[t.type].set);default:if(t.isStructType)return function(t){return function(e){var n,s,r,i,o;if(!Tt(e))throw new TypeError(u("invalid assignment. `%s` must be a `struct` instance. Value: `%s`.",t.name,e));if("none"===t.casting&&!(e instanceof t.type))throw new TypeError(u("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Value: `%s`.",t.name,e));if(o=t.byteLength,(i=this.constructor.viewOf(e)).byteLength!==o)throw new RangeError(u("invalid assignment. `%s` must be a `struct` instance having the same byte length.",t.name));r=new q(i.buffer,i.byteOffset,o),n=this[pt],s=new q(n.buffer,n.byteOffset+t.byteOffset,o),C(t.length,r,1,s,1)}}(t);throw new Error(u("unexpected error. Unrecognized data type. Value: `%s`.",t.type))}}var St=["name","type","description","length","enumerable","writable","default","castingMode"];function Ft(t){return"union"===t.type&&s(t.fields)}function Ut(t,e){return N(t)?null:new TypeError(u("invalid argument. `%s` field must be a boolean. Value: `%s`.",e,t))}var It=["int8","int16","int32","int64","uint8","uint16","uint32","uint64","float32","float64","complex64","complex128","bool"];var Jt,Nt={int8:1,int16:2,int32:4,int64:8,uint8:1,uint16:2,uint32:4,uint64:8,float16:2,float32:4,float64:8,complex32:2,complex64:4,complex128:8,bool:1},Pt=["name","type"],Mt={name:function(t,e){return rt(t)||t.length>0?null:new TypeError(u("invalid argument. `%s` field must be a non-empty string. Value: `%s`.",e,t))},type:function(t){return it(It,t)||Tt(t)?null:new TypeError(u('invalid argument. `%s` field must be either a `struct` or one of the following: "%s". Value: `%s`.',"type",a(It,", "),t))},description:function(t,e){return rt(t)?null:new TypeError(u("invalid argument. `%s` field must be a string. Value: `%s`.",e,t))},length:function(t,e){return G(t)?null:new TypeError(u("invalid argument. `%s` field must be a positive integer. Value: `%s`.",e,t))},enumerable:Ut,writable:Ut,default:st(null),castingMode:(Jt=["none","safe","mostly-safe","same-kind","unsafe"],function(t,e){return it(Jt,t)?null:new TypeError(u('invalid argument. `%s` field must be one of the following: "%s". Value: `%s`.',e,a(Jt,", "),t))})};function _t(t,e){var n,s,r,i,l;for(n={isStructType:!1,description:"",byteLength:0,byteOffset:0,alignment:0,padding:0,enumerable:!0,writable:!0,default:void 0,castingMode:"none"},l=0;l<e.length;l++)if(i=e[l],o(t,i)){if(r=t[i],s=Mt[i](r,i))return s;n[i]=r}return function(t,e){var n;for(n=0;n<e.length;n++)if(!o(t,e[n]))return!1;return!0}(n,Pt)?(n.isStructType=Tt(n.type),n.byteLength=function(t){var e;return e=t.isStructType?t.type.constructor.byteLength:at(t.type),t.length&&(e*=t.length),e}(n),n.isStructType?n.alignment=n.type.constructor.alignment:n.alignment=Nt[n.type],n):new TypeError(u('invalid argument. Field objects must have the following properties: "%s". Value: `%s`.',a(Pt,", "),JSON.stringify(t)))}function kt(t){var e,n,s;for(e=0,s=0;s<t.length;s++)(n=t[s].alignment)>e&&(e=n);return e}function At(t){var e,n,s,r,a,l,d;if(0===(e=t.fields).length)return null;for(s=[],d=0;d<e.length;d++){if(l=e[d],!i(l))return null;if(Ft(l))return new TypeError(u("invalid argument. Union types cannot contain nested union types. Value: `%s`.",JSON.stringify(e)));if(void 0===n&&o(l,"default"))n=!0;else if(!0===n&&o(l,"default"))return new TypeError(u("invalid argument. Union types can only contain one field with a default value. Value: `%s`.",JSON.stringify(e)));if((r=_t(l,St))instanceof Error)return r;if(0===d)a=r.byteLength;else if(r.byteLength!==a)return new RangeError(u("invalid argument. Union types must contain fields having the same byte length. Value: `%s`.",JSON.stringify(e)));s.push(r)}return{type:"union",fields:s,byteLength:a,byteOffset:0,alignment:kt(s),padding:0}}function Bt(t,e){var n;for(n=0;n<t.length;n++)t[n].padding=e;return t}var Rt=["none","linear"],Dt=ot(Rt);function $t(t,e,n){var s;if(!dt(n))throw new TypeError(u("null2V",n));if(s={format:"none"},ft(n,"format")&&(s.format=n.format,!Dt(s.format)))throw new TypeError(u("null4S","format",a(Rt,", "),n.format));return"linear"===s.format?function(t,e){var n,s,r,i,o,a,l,d,f,m,p,c,g,h,y,b,v,j,w,x,O;for(b=e.length,n="%"+(t.constructor.byteLength-1).toString().length+"s",h=0,w=0;w<b;w++)(y=(v=e[w]).name.length+1+(v.byteLength-1).toString().length+1)>h&&(h=y);for(s="%"+h+"s",r="// %s",a="%s: %s   %s",m=0,d=[],w=0;w<b;w++)if(v=e[w],!(w>0&&v.byteOffset===e[w-1].byteOffset)){for(f=w<b-1&&v.byteOffset===e[w+1].byteOffset,x=0;x<v.byteLength;x++){if(p=u(n,m.toString()),c=u(s,u("%s[%u]",v.name,x)),i=v.alignment>1?" (byte %u)":"",f){for(o=" => union: %s",l=[],O=w+1;O<b&&v.byteOffset===e[O].byteOffset;)j=e[O],l.push(u("%s<%s>[%u]",j.name,j.type,x%j.alignment)),O+=1;o=u(o,l.join(", "))}else o="";l=u(i+o,x%v.alignment),g=v.length?u(r,u("%s[%u]%s",v.type,z(x/v.alignment),l)):u(r,u("%s%s",v.type,l)),d.push(u(a,p,c,g)),m+=1}for(x=0;x<v.padding;x++)p=u(n,m.toString()),c=u(s,"--"),g=u(r,"padding"),d.push(u(a,p,c,g)),m+=1}return d.join("\n")}(t,e):"<Struct>"}function zt(h){var y,b,v,j,w,x,O,E;if(!s(h))throw new TypeError(u("null2O",h));if(O=function(t){var e,n,s,r;for(e=[],r=0;r<t.length;r++){if(s=t[r],!i(s))return new TypeError(u("invalid argument. First argument must be an array of objects. Value: `%s`. Index: `%d`.",s,r));if(Ft(s)){if(null===(n=At(s)))return new TypeError(u("invalid argument. Union types must be an array of objects. Value: `%s`. Index: `%d`.",JSON.stringify(s),r));if(n instanceof Error)return n}else if((n=_t(s,St))instanceof Error)return n;e.push(n)}return e}(h),O instanceof Error)throw O;if(O=function(t){var e,n,s,r,i,o;for(e={},n=[],r=0;r<t.length;r++)if(o=(s=t[r]).name,Ft(s))for(i=0;i<s.fields.length;i++){if(!0===e[o=s.fields[i].name])return new TypeError(u("invalid argument. First argument must be an array of objects having unique field names. Value: `%s`.",JSON.stringify(t)));e[o]=!0,n.push(o)}else{if(!0===e[o])return new TypeError(u("invalid argument. First argument must be an array of objects having unique field names. Value: `%s`.",JSON.stringify(t)));e[o]=!0,n.push(o)}return n}(x=O),O instanceof Error)throw O;function T(e,s,a){var d,p,c,g,h,j,O,E,V,L;if(p=arguments.length,!(this instanceof T))return 0===p?new T:1===p?new T(e):2===p?new T(e,s):new T(e,s,a);if(r(e)){if(1===p)g=new m(e);else{if(!n(s))throw new TypeError(u("null2C",s));if(2===p)g=new m(e,s);else{if(!n(a))throw new TypeError(u("invalid argument. Byte length must be a nonnegative integer. Value: `%s`.",a));g=new m(e,s,a)}}if(g.byteLength<b)throw new RangeError(u("invalid argument. ArrayBuffer has insufficient capacity. Minimum capacity: `%u`.",b))}else if(g=new m(new f(b)),p>0){if(!i(e))throw new TypeError(u("null3L",e));h=e}if(t(this,pt,g),void 0!==h){for(d=l(void 0,x.length),c={},E=0;E<x.length;E++)if(L=y[E],V=v[E],o(h,L)){if(c[V])throw new Error("invalid argument. Union types may only be initialized by a single member.");d[E]=h[L],c[V]=!0}for(E=0;E<x.length;E++)c[V=v[E]]||void 0!==(j=x[E]).default&&(d[E]=j.default);for(E=0;E<x.length;E++)void 0!==(O=d[E])&&w[y[E]][1].call(this,O)}return this}return y=O,j=kt(x),x=function(t,e){var n,s,r,i,o,a,l;for(r=0,a=0;a<t.length;a++){if(o=t[a],r+=s=((n=lt(o.alignment,e))-r%n)%n,a>0&&((i=t[a-1]).padding=s,Ft(o)&&Bt(i.fields,s)),o.byteOffset=r,Ft(o))for(l=0;l<o.fields.length;l++)o.fields[l].byteOffset=r;r+=o.byteLength}return s=(n-r%n)%n,o.padding=s,Ft(o)&&Bt(o.fields,s),t}(x,j),x=function(t){var e,n,s,r;for(e=[],s=0;s<t.length;s++)if(Ft(n=t[s]))for(r=0;r<n.fields.length;r++)e.push(n.fields[r]);else e.push(n);return e}(x),v=function(t){var e,n,s,r;for(n=t.length,e=[],r=0,s=0;s<n-1;s++)t[s].byteOffset!==t[s+1].byteOffset?(e.push(r),r+=1):e.push(r);return e.push(r),e}(x),E=x[x.length-1],b=E.byteOffset+E.byteLength+E.padding,t(T,"name",ct),t(T,"alignment",j),t(T,"byteLength",b),e(T,"fields",(function(){return y.slice()})),t(T,"byteLengthOf",(function(t){var e;if(0===y.length)throw new Error("invalid operation. struct does not have any fields.");if((e=d(y,t,0))<0)throw new TypeError(u('invalid argument. First argument must be one of the following: "%s". Value: `%s`.',a(y,", "),t));return x[e].byteLength})),t(T,"byteOffsetOf",(function(t){var e;if(0===y.length)throw new Error("invalid operation. struct does not have any fields.");if((e=d(y,t,0))<0)throw new TypeError(u('invalid argument. First argument must be one of the following: "%s". Value: `%s`.',a(y,", "),t));return x[e].byteOffset})),t(T,"descriptionOf",(function(t){var e;if(0===y.length)throw new Error("invalid operation. struct does not have any fields.");if((e=d(y,t,0))<0)throw new TypeError(u('invalid argument. First argument must be one of the following: "%s". Value: `%s`.',a(y,", "),t));return x[e].description})),t(T,"bufferOf",(function(t){if(!Tt(t))throw new TypeError(u("invalid argument. First argument must be a `struct` instance. Value: `%s`.",t));return t[pt].buffer})),t(T,"viewOf",(function(t){var e;if(!Tt(t))throw new TypeError(u("invalid argument. First argument must be a `struct` instance. Value: `%s`.",t));return e=t[pt],new m(e,e.byteOffset,e.byteLength)})),w=function(t,n){var s,r,i,o,a;for(i={},a=0;a<n.length;a++)s=yt(o=n[a]),r=Lt(o),o.enumerable?o.writable?g(t,o.name,s,r):c(t,o.name,s):o.writable?p(t,o.name,s,r):e(t,o.name,s),i[o.name]=[s,r];return i}(T.prototype,x),t(T.prototype,"toString",(function(){if(!(this instanceof T))throw new Error("invalid invocation. `this` is not a struct instance.");return $t(this,x,arguments.length>0?arguments[0]:{})})),t(T.prototype,"toJSON",(function(){if(!(this instanceof T))throw new Error("invalid invocation. `this` is not a struct instance.");return function(t,e){var n,r,i,o;for(n={},o=0;o<e.length;o++)i=t[(r=e[o]).name],s(i)?i=ut(i):(Tt(i)||V(i)&&mt(i.toJSON))&&(i=i.toJSON()),n[r.name]=i;return n}(this,x)})),T}export{zt as default};
//# sourceMappingURL=index.mjs.map
