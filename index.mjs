// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-accessor@v0.2.2-esm/index.mjs";import{isPrimitive as n}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-arraybuffer@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-fast-min@v0.3.0-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-filled@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-buffer@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dataview@v0.2.2-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-write-accessor@v0.2.2-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-read-only-accessor@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-read-write-accessor@v0.2.2-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-little-endian@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/boolean-ctor@esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-cmplx@esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/array-typed@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-real-floating-point-data-type@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-signed-integer-data-type@esm/index.mjs";import{isPrimitive as w}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-number@esm/index.mjs";import{isPrimitive as x}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import{isPrimitive as O}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@esm/index.mjs";import{isPrimitive as E}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-bigint@esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-complex-like@esm/index.mjs";import S from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-allowed-data-type-cast@esm/index.mjs";import L from"https://cdn.jsdelivr.net/gh/stdlib-js/array-min-dtype@esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-min-signed-integer-dtype@esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-dtype@esm/index.mjs";import U from"https://cdn.jsdelivr.net/gh/stdlib-js/number-ctor@esm/index.mjs";import I from"https://cdn.jsdelivr.net/gh/stdlib-js/bigint-ctor@esm/index.mjs";import J from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-floor@esm/index.mjs";import N from"https://cdn.jsdelivr.net/gh/stdlib-js/array-uint8@esm/index.mjs";import M from"https://cdn.jsdelivr.net/gh/stdlib-js/blas-base-gcopy@esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-dataview@v0.2.2-esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-complex-floating-point-data-type@esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-boolean-data-type@esm/index.mjs";import P from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-real-data-type@esm/index.mjs";import B from"https://cdn.jsdelivr.net/gh/stdlib-js/array-dtype@esm/index.mjs";import R from"https://cdn.jsdelivr.net/gh/stdlib-js/strided-base-reinterpret-complex@esm/index.mjs";import D from"https://cdn.jsdelivr.net/gh/stdlib-js/strided-base-reinterpret-boolean@esm/index.mjs";import $ from"https://cdn.jsdelivr.net/gh/stdlib-js/blas-ext-base-gfill@esm/index.mjs";import z from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-map@esm/index.mjs";import q from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import C from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-constant-function@v0.2.2-esm/index.mjs";import{isPrimitive as G}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-positive-integer@esm/index.mjs";import H from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@esm/index.mjs";import{isPrimitive as K}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import{isPrimitive as Q}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@v0.2.2-esm/index.mjs";import{isPrimitive as W}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.2.2-esm/index.mjs";import X,{factory as Y}from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import Z from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-bytes-per-element@v0.2.2-esm/index.mjs";import tt from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-index-of@v0.2.2-esm/index.mjs";import et from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import nt from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import st from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-floor@v0.2.3-esm/index.mjs";import rt from"https://cdn.jsdelivr.net/gh/stdlib-js/string-base-replace@v0.2.2-esm/index.mjs";import it from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-complex-like@v0.2.2-esm/index.mjs";import at from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import ot from"https://cdn.jsdelivr.net/gh/stdlib-js/array-to-json@v0.3.0-esm/index.mjs";var lt="__@@##$$@@__struct_buffer__@@$$##@@__",ft={int8:{get:"getInt8",set:"setInt8"},int16:{get:"getInt16",set:"setInt16"},int32:{get:"getInt32",set:"setInt32"},int64:{get:"getBigInt64",set:"setBigInt64"},uint8:{get:"getUint8",set:"setUint8"},uint16:{get:"getUint16",set:"setUint16"},uint32:{get:"getUint32",set:"setUint32"},uint64:{get:"getBigUint64",set:"setBigUint64"},float16:{get:"getFloat16",set:"setFloat16"},float32:{get:"getFloat32",set:"setFloat32"},float64:{get:"getFloat64",set:"setFloat64"},complex32:{get:"getFloat16",set:"setFloat16"},complex64:{get:"getFloat32",set:"setFloat32"},complex128:{get:"getFloat64",set:"setFloat64"},bool:{get:"getUint8",set:"setUint8"}};var dt={complex128:"float64",complex64:"float32",complex32:"float16"};function mt(t){if(t.length)return t.isStructType?function(t){return function(){var e,n,s,r;for(e=(n=this[lt]).byteOffset+t.byteOffset,s=[],r=0;r<t.length;r++)s.push(new t.type(n.buffer,e,t.byteLength)),e+=t.byteOffset;return s}}(t):function(t){return function(){var e=this[lt];return b(e.buffer,e.byteOffset+t.byteOffset,t.length,t.type)}}(t);switch(t.type){case"float64":case"float32":case"float16":case"int8":case"int16":case"int32":case"uint8":case"uint16":case"uint32":case"int64":case"uint64":return function(t,e){return function(){return this[lt][e](t.byteOffset,g)}}(t,ft[t.type].get);case"bool":return function(t,e){return function(){var n=this[lt];return h(n[e](t.byteOffset,g))}}(t,ft[t.type].get);case"complex128":case"complex64":case"complex32":return function(t,e){return function(){var n=this[lt],s=n[e](t.byteOffset,g),r=n[e](t.byteOffset+t.byteLength/2,g);return y(s,r,dt[t.type])}}(t,ft[t.type].get);default:if(t.isStructType)return function(t){return function(){var e=this[lt];return new t.type(e.buffer,e.byteOffset+t.byteOffset,t.byteLength)}}(t);throw new Error(m("unexpected error. Unrecognized data type. Value: `%s`.",t.type))}}function ut(t){return t?1:0}function pt(t){return U(t)}var ct={dtypes:{real:"float64",complex:"complex128"}};function gt(t){return h(t)}function ht(t){return h(t.re||t.im)}function yt(t,e){return function(n){var s,r;x(n)?(s="bool",r=ut(n)):w(n)?(s=ct.dtypes.real,r=ut(gt(n))):E(n)?(s="int64",r=ut(function(t){return h(t)}(n))):T(n)?(s=F(n)||ct.dtypes.complex,r=ut(ht(n))):(s="generic",r=h(n));if(!S(s,t.type,t.castingMode))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[lt][e](t.byteOffset,r,g)}}function bt(t,e){return function(n){var s,r;E(n)?(s="int64",r=n):w(n)?O(n)?(s=L(n),r=I(n)):(s=ct.dtypes.real,r=I(J(n))):x(n)?(s="bool",r=function(t){return I(t?1:0)}(n)):T(n)?(s=F(n)||ct.dtypes.complex,r=I(J(n.re))):(s="generic",r=I(J(U(r))));if(!S(s,t.type,t.castingMode))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[lt][e](t.byteOffset,r,g)}}function vt(t){return i(t)&&_(t[lt])}function jt(t){return t.re}function wt(t){if(t.length)return t.isStructType?function(t){return function(e){var n,r,i,a,o,l,f,d;if(!s(e))throw new TypeError(m("invalid assignment. `%s` must be an array-like object. Value: `%s`.",t.name,e));if(e.length!==t.length)throw new RangeError(m("invalid assignment. `%s` must be an array-like object having length %u.",t.name,t.length));if("none"===t.casting)for(d=0;d<e.length;d++)if(!(e[d]instanceof t.type))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Value: `%s`.",t.name,e[d]));for(f=t.byteLength/t.length,r=[],d=0;d<e.length;d++){if((l=this.constructor.viewOf(e[d])).byteLength!==f)throw new RangeError(m("invalid assignment. `%s` must be an array-like object containing `struct` instances having the same byte length.",t.name));o=new N(l.buffer,l.byteOffset,f),r.push(o)}for(n=(i=this[lt]).byteOffset+t.byteOffset,d=0;d<e.length;d++)a=new N(i.buffer,n,f),M(t.length,r[d],1,a,1),n+=f}}(t):function(t){return function(e){var n,r,i;if(!s(e)||vt(e))throw new TypeError(m("invalid assignment. `%s` must be an array-like object. Value: `%s`.",t.name,e));if(e.length!==t.length)throw new RangeError(m("invalid assignment. `%s` must be an array-like object having length %u.",t.name,t.length));if(i=B(e),!S(i,t.type,t.castingMode))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,i));return r=this[lt],n=b(r.buffer,r.byteOffset+t.byteOffset,t.length,t.type),i===t.type?k(i)?void M(2*t.length,R(e,0),1,R(n,0),1):A(i)?void M(t.length,D(e,0),1,D(n,0),1):void M(t.length,e,1,n,1):P(i)?P(t.type)?void M(t.length,e,1,n,1):k(t.type)?(n=R(n,0),M(t.length,n,2,e,1),void $.ndarray(t.length,0,n,2,1)):void z.assign(e,n,1,0,gt):k(i)?P(t.type)?void z.assign(e,n,1,0,jt):k(t.type)?void M(2*t.length,R(e,0),1,R(n,0),1):void z.assign(e,n,1,0,ht):void(P(t.type)?M(t.length,D(e,0),1,n,1):(n=R(n,0),M(t.length,n,2,D(e,0),1),$.ndarray(t.length,0,n,2,1)))}}(t);switch(t.type){case"float64":case"float32":case"float16":case"int8":case"int16":case"int32":case"uint8":case"uint16":case"uint32":return function(t,e){return function(n){var s,r;if(w(n)?(s=v(t.type)?t.type:O(n)?j(t.type)?V(n):L(n):ct.dtypes.real,r=n):T(n)?(s=F(n)||("float32"===t.type?"complex64":"complex128"),r=n.re):x(n)?(s="bool",r=ut(n)):E(n)?(s="int64",r=pt(n)):(s="generic",r=n),!S(s,t.type,t.castingMode))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,s));this[lt][e](t.byteOffset,r,g)}}(t,ft[t.type].set);case"int64":case"uint64":return bt(t,ft[t.type].set);case"bool":return yt(t,ft[t.type].set);case"complex128":case"complex64":case"complex32":return function(t,e){return function(n){var s,r,i,a;if(T(n)?(r=F(n)||t.type,i=n.re,a=n.im):w(n)?(r="complex64"===t.type?"float32":"float64",i=n,a=0):E(n)?(r="int64",i=pt(n),a=0):x(n)?(r="bool",i=ut(n),a=0):(r="generic",i=n,a=0),!S(r,t.type,t.castingMode))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Data types: [%s, %s].",t.name,t.type,r));(s=this[lt])[e](t.byteOffset,i,g),s[e](t.byteOffset+t.byteLength/2,a,g)}}(t,ft[t.type].set);default:if(t.isStructType)return function(t){return function(e){var n,s,r,i,a;if(!vt(e))throw new TypeError(m("invalid assignment. `%s` must be a `struct` instance. Value: `%s`.",t.name,e));if("none"===t.casting&&!(e instanceof t.type))throw new TypeError(m("invalid assignment. Assigned value cannot be cast to the data type of `%s`. Value: `%s`.",t.name,e));if(a=t.byteLength,(i=this.constructor.viewOf(e)).byteLength!==a)throw new RangeError(m("invalid assignment. `%s` must be a `struct` instance having the same byte length.",t.name));r=new N(i.buffer,i.byteOffset,a),n=this[lt],s=new N(n.buffer,n.byteOffset+t.byteOffset,a),M(t.length,r,1,s,1)}}(t);throw new Error(m("unexpected error. Unrecognized data type. Value: `%s`.",t.type))}}var xt=["name","type","description","length","enumerable","writable","default","castingMode"];function Ot(t){return"union"===t.type&&s(t.fields)}function Et(t){return H(t)&&G(t.alignment)&&G(t.byteLength)&&H(t.byteLengthOf)&&H(t.byteOffsetOf)&&H(t.bufferOf)&&H(t.viewOf)}function Tt(t,e){return W(t)?null:new TypeError(m("invalid argument. `%s` field must be a boolean. Value: `%s`.",e,t))}var St=["int8","int16","int32","int64","uint8","uint16","uint32","uint64","float32","float64","complex64","complex128","bool"];var Lt,Vt={int8:1,int16:2,int32:4,int64:8,uint8:1,uint16:2,uint32:4,uint64:8,float16:2,float32:4,float64:8,complex32:2,complex64:4,complex128:8,bool:1},Ft=["name","type"],Ut={name:function(t,e){return K(t)||t.length>0?null:new TypeError(m("invalid argument. `%s` field must be a non-empty string. Value: `%s`.",e,t))},type:function(t){return X(St,t)||Et(t)?null:new TypeError(m('invalid argument. `%s` field must be either a struct type or one of the following: "%s". Value: `%s`.',"type",q(St,", "),t))},description:function(t,e){return Q(t)?null:new TypeError(m("invalid argument. `%s` field must be a string. Value: `%s`.",e,t))},length:function(t,e){return G(t)?null:new TypeError(m("invalid argument. `%s` field must be a positive integer. Value: `%s`.",e,t))},enumerable:Tt,writable:Tt,default:C(null),castingMode:(Lt=["none","safe","mostly-safe","same-kind","unsafe"],function(t,e){return X(Lt,t)?null:new TypeError(m('invalid argument. `%s` field must be one of the following: "%s". Value: `%s`.',e,q(Lt,", "),t))})};function It(t,e){var n,s,r,i,o;for(n={isStructType:!1,description:"",byteLength:0,byteOffset:0,alignment:0,padding:0,enumerable:!0,writable:!0,default:void 0,castingMode:"none"},o=0;o<e.length;o++)if(i=e[o],a(t,i)){if(r=t[i],s=Ut[i](r,i))return s;n[i]=r}return function(t,e){var n;for(n=0;n<e.length;n++)if(!a(t,e[n]))return!1;return!0}(n,Ft)?(n.isStructType=Et(n.type),n.byteLength=function(t){var e;return e=t.isStructType?t.type.byteLength:Z(t.type),t.length&&(e*=t.length),e}(n),n.isStructType?n.alignment=n.type.alignment:n.alignment=Vt[n.type],n):new TypeError(m('invalid argument. Field objects must have the following properties: "%s". Value: `%s`.',q(Ft,", "),JSON.stringify(t)))}function Jt(t){var e,n,s;for(e=0,s=0;s<t.length;s++)(n=t[s].alignment)>e&&(e=n);return e}function Nt(t){var e,n,s,r,o,l,f;if(0===(e=t.fields).length)return null;for(s=[],f=0;f<e.length;f++){if(l=e[f],!i(l))return null;if(Ot(l))return new TypeError(m("invalid argument. Union types cannot contain nested union types. Value: `%s`.",JSON.stringify(e)));if(void 0===n&&a(l,"default"))n=!0;else if(!0===n&&a(l,"default"))return new TypeError(m("invalid argument. Union types can only contain one field with a default value. Value: `%s`.",JSON.stringify(e)));if((r=It(l,xt))instanceof Error)return r;if(0===f)o=r.byteLength;else if(r.byteLength!==o)return new RangeError(m("invalid argument. Union types must contain fields having the same byte length. Value: `%s`.",JSON.stringify(e)));s.push(r)}return{type:"union",fields:s,byteLength:o,byteOffset:0,alignment:Jt(s),padding:0}}function Mt(t,e){var n;return 0===t.length?new Error("invalid operation. struct does not have any fields."):(n=tt(t,e,0))<0?new TypeError(m('invalid argument. Field name must be one of the following: "%s". Value: `%s`.',q(t,", "),e)):n}function _t(t,e){var n;for(n=0;n<t.length;n++)t[n].padding=e;return t}function kt(t){return function(e,n){return m("[%u,",t+parseInt(n,10))}}function At(t){var e,n,s,r,i,a;for(r=t.length,s=/\[(\d{1,}),/g,e=[],a=0;a<r;a++)i=t[a],a>0&&i.byteOffset===t[a-1].byteOffset||(i.isStructType?e.push(rt(i.type.layout,s,kt(i.byteOffset))):e.push(m("|<%s>[%u,%u]",i.type,i.byteOffset,i.byteLength)));return"|"===(n=m("%s|",e.join("")))[n.length-2]&&(n=n.substring(0,n.length-1)),n}var Pt=["none","linear","layout"],Bt=Y(Pt);function Rt(t,e,n){var s;if(!et(n))throw new TypeError(m("null2V",n));if(s={format:"none"},nt(n,"format")&&(s.format=n.format,!Bt(s.format)))throw new TypeError(m("null4S","format",q(Pt,", "),n.format));return"linear"===s.format?function(t,e){var n,s,r,i,a,o,l,f,d,u,p,c,g,h,y,b,v,j,w,x,O,E;for(b=e.length,n="%"+(t.byteLength-1).toString().length+"s",h=0,x=0;x<b;x++)(y=(v=e[x]).name.length+1+(v.byteLength-1).toString().length+1)>h&&(h=y);for(s="%"+h+"s",r="// %s",o="%s: %s   %s",u=0,f=[],x=0;x<b;x++)if(v=e[x],!(x>0&&v.byteOffset===e[x-1].byteOffset)){for(d=x<b-1&&v.byteOffset===e[x+1].byteOffset,O=0;O<v.byteLength;O++){if(p=m(n,u.toString()),c=m(s,m("%s[%u]",v.name,O)),i=v.alignment>1?" (byte %u)":"",d){for(a=" => union: %s",l=[],E=x+1;E<b&&v.byteOffset===e[E].byteOffset;)w=(j=e[E]).isStructType?"<Struct>":j.type,l.push(m("%s<%s>[%u]",j.name,w,O%j.alignment)),E+=1;a=m(a,l.join(", "))}else a="";l=m(i+a,O%v.alignment),g=v.length?m(r,m("%s[%u]%s",v.type,st(O/v.alignment),l)):m(r,m("%s%s",v.type,l)),f.push(m(o,p,c,g)),u+=1}for(O=0;O<v.padding;O++)p=m(n,u.toString()),c=m(s,"--"),g=m(r,"padding"),f.push(m(o,p,c,g)),u+=1}return f.join("\n")}(t.constructor,e):"layout"===s.format?At(e):"<Struct>"}function Dt(g){var h,y,b,v,j,w,x,O;if(!s(g))throw new TypeError(m("null2O",g));if(x=function(t){var e,n,s,r;for(e=[],r=0;r<t.length;r++){if(s=t[r],!i(s))return new TypeError(m("invalid argument. First argument must be an array of objects. Value: `%s`. Index: `%d`.",s,r));if(Ot(s)){if(null===(n=Nt(s)))return new TypeError(m("invalid argument. Union types must be an array of objects. Value: `%s`. Index: `%d`.",JSON.stringify(s),r));if(n instanceof Error)return n}else if((n=It(s,xt))instanceof Error)return n;e.push(n)}return e}(g),x instanceof Error)throw x;if(x=function(t){var e,n,s,r,i,a;for(e={},n=[],r=0;r<t.length;r++)if(a=(s=t[r]).name,Ot(s))for(i=0;i<s.fields.length;i++){if(!0===e[a=s.fields[i].name])return new TypeError(m("invalid argument. First argument must be an array of objects having unique field names. Value: `%s`.",JSON.stringify(t)));e[a]=!0,n.push(a)}else{if(!0===e[a])return new TypeError(m("invalid argument. First argument must be an array of objects having unique field names. Value: `%s`.",JSON.stringify(t)));e[a]=!0,n.push(a)}return n}(w=x),x instanceof Error)throw x;function E(e,s,u){var p,c,g,v,x,O,T,S,L,V;if(c=arguments.length,!(this instanceof E))return 0===c?new E:1===c?new E(e):2===c?new E(e,s):new E(e,s,u);if(r(e)){if(1===c)v=new d(e,0,y);else{if(!n(s))throw new TypeError(m("null2C",s));if(2===c)v=new d(e,s,y);else{if(!n(u))throw new TypeError(m("invalid argument. Byte length must be a nonnegative integer. Value: `%s`.",u));v=new d(e,s,o(u,y))}}if(v.byteLength<y)throw new RangeError(m("invalid argument. ArrayBuffer has insufficient capacity. Minimum capacity: `%u`.",y))}else if(v=new d(new f(y)),c>0){if(!i(e))throw new TypeError(m("null3L",e));x=e}if(t(this,lt,v),void 0!==x){for(p=l(void 0,w.length),g={},S=0;S<w.length;S++)if(V=h[S],L=b[S],a(x,V)){if(g[L])throw new Error("invalid argument. Union types may only be initialized by a single member.");p[S]=x[V],g[L]=!0}for(S=0;S<w.length;S++)g[L=b[S]]||void 0!==(O=w[S]).default&&(p[S]=O.default);for(S=0;S<w.length;S++)void 0!==(T=p[S])&&j[h[S]][1].call(this,T)}return this}return h=x,v=Jt(w),w=function(t,e){var n,s,r,i,a,l,f;for(r=0,l=0;l<t.length;l++){if(a=t[l],r+=s=((n=o(a.alignment,e))-r%n)%n,l>0&&((i=t[l-1]).padding=s,Ot(a)&&_t(i.fields,s)),a.byteOffset=r,Ot(a))for(f=0;f<a.fields.length;f++)a.fields[f].byteOffset=r;r+=a.byteLength}return s=(n-r%n)%n,a.padding=s,Ot(a)&&_t(a.fields,s),t}(w,v),w=function(t){var e,n,s,r;for(e=[],s=0;s<t.length;s++)if(Ot(n=t[s]))for(r=0;r<n.fields.length;r++)e.push(n.fields[r]);else e.push(n);return e}(w),b=function(t){var e,n,s,r;for(n=t.length,e=[],r=0,s=0;s<n-1;s++)t[s].byteOffset!==t[s+1].byteOffset?(e.push(r),r+=1):e.push(r);return e.push(r),e}(w),O=w[w.length-1],y=O.byteOffset+O.byteLength+O.padding,t(E,"name","Struct"),t(E,"alignment",v),t(E,"byteLength",y),e(E,"fields",(function(){return h.slice()})),e(E,"layout",(function(){return At(w)})),t(E,"byteLengthOf",(function(t){var e=Mt(h,t);if(e instanceof Error)throw e;return w[e].byteLength})),t(E,"byteOffsetOf",(function(t){var e=Mt(h,t);if(e instanceof Error)throw e;return w[e].byteOffset})),t(E,"descriptionOf",(function(t){var e=Mt(h,t);if(e instanceof Error)throw e;return w[e].description})),t(E,"typeOf",(function(t){var e=Mt(h,t);if(e instanceof Error)throw e;return w[e].type})),t(E,"bufferOf",(function(t){if(!vt(t))throw new TypeError(m("invalid argument. First argument must be a `struct` instance. Value: `%s`.",t));return t[lt].buffer})),t(E,"viewOf",(function(t){var e;if(!vt(t))throw new TypeError(m("invalid argument. First argument must be a `struct` instance. Value: `%s`.",t));return e=t[lt],new d(e.buffer,e.byteOffset,e.byteLength)})),j=function(t,n){var s,r,i,a,o;for(i={},o=0;o<n.length;o++)s=mt(a=n[o]),r=wt(a),a.enumerable?a.writable?c(t,a.name,s,r):p(t,a.name,s):a.writable?u(t,a.name,s,r):e(t,a.name,s),i[a.name]=[s,r];return i}(E.prototype,w),t(E.prototype,"toString",(function(){if(!(this instanceof E))throw new Error("invalid invocation. `this` is not a struct instance.");return Rt(this,w,arguments.length>0?arguments[0]:{})})),t(E.prototype,"toJSON",(function(){if(!(this instanceof E))throw new Error("invalid invocation. `this` is not a struct instance.");return function(t,e){var n,r,i,a;for(n={},a=0;a<e.length;a++)i=t[(r=e[a]).name],s(i)?i=ot(i):(vt(i)||it(i)&&at(i.toJSON))&&(i=i.toJSON()),n[r.name]=i;return n}(this,w)})),E}export{Dt as default};
//# sourceMappingURL=index.mjs.map
